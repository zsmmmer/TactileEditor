<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Draggable Polygon with D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      .polygon {
        fill: lightblue;
        stroke: black;
        stroke-width: 2px;
      }
      .point {
        fill: red;
        stroke: black;
        stroke-width: 1px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <svg width="600" height="600"></svg>
    <script>
      const svg = d3.select("svg");

      // Define the vertices of the polygon
      const vertices = [
        { x: 100, y: 100 },
        { x: 200, y: 80 },
        { x: 300, y: 120 },
        { x: 320, y: 220 },
        { x: 220, y: 300 },
        { x: 120, y: 260 },
      ];

      // Function to update the polygon
      function updatePolygon() {
        polygon.attr(
          "points",
          vertices.map((d) => [d.x, d.y].join(",")).join(" ")
        );
        points
          .data(vertices)
          .attr("cx", (d) => d.x)
          .attr("cy", (d) => d.y);
      }

      // Draw the polygon
      const polygon = svg
        .append("polygon")
        .attr("class", "polygon")
        .call(
          d3.drag().on("drag", function (event) {
            const dx = event.dx;
            const dy = event.dy;
            vertices.forEach((d) => {
              d.x += dx;
              d.y += dy;
            });
            updatePolygon();
          })
        );

      // Draw the points
      const points = svg
        .selectAll(".point")
        .data(vertices)
        .enter()
        .append("circle")
        .attr("class", "point")
        .attr("r", 5)
        .attr("cx", (d) => d.x)
        .attr("cy", (d) => d.y)
        .call(
          d3.drag().on("drag", function (event, d) {
            d.x = event.x;
            d.y = event.y;
            updatePolygon();
          })
        );

      // Initial polygon update
      updatePolygon();
    </script>
  </body>
</html>

<!-- 说明：
SVG设置：使用 D3.js 选择 SVG 元素。
顶点定义：定义多边形的顶点数组 vertices。
更新多边形函数：定义 updatePolygon 函数，用于更新多边形的点和顶点位置。
绘制多边形：使用 polygon 元素绘制多边形，并为其添加拖拽功能，使整个多边形可以被拖动。
绘制顶点：使用 circle 元素绘制顶点，并为每个顶点添加拖拽功能，使其位置可以被独立拖动。
初始更新：调用 updatePolygon 函数进行初始绘制。
功能：
多边形拖动：用户可以通过点击并拖动多边形的任意位置来移动整个多边形。
顶点拖动：用户可以通过点击并拖动多边形的顶点来调整多边形的形状。
通过这种方式，你可以使用 D3.js 创建一个可交互的多边形，并实现用户可以通过鼠标点击并拖拽移动多边形各个点的位置的功能。 -->
